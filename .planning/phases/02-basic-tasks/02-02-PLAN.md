---
phase: 02-basic-tasks
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - src/components/ui/badge.tsx
  - src/pages/App/Project/Tasks.tsx
  - src/pages/App/Project/TaskRow.tsx
  - src/pages/App/Project/CreateTaskInline.tsx
  - src/pages/App/Project/ProjectDetails.tsx
  - src/routes.tsx
autonomous: true

must_haves:
  truths:
    - "User can see a task list on a project page with compact rows showing title, status badge, priority icon, and assignee avatar"
    - "User can type a title and press Enter to create a task inline (quick add)"
    - "Completed tasks are hidden by default with a toggle to show them"
    - "Task list is sorted by creation date (newest first)"
    - "Empty state shows helpful message when project has no tasks"
  artifacts:
    - path: "src/components/ui/badge.tsx"
      provides: "Badge component for status indicators"
      contains: "Badge"
    - path: "src/pages/App/Project/Tasks.tsx"
      provides: "Main task list view with hide-completed toggle"
      contains: "Tasks"
    - path: "src/pages/App/Project/TaskRow.tsx"
      provides: "Compact task row with status badge, priority icon, assignee avatar"
      contains: "TaskRow"
    - path: "src/pages/App/Project/CreateTaskInline.tsx"
      provides: "Inline task creation with Enter to submit"
      contains: "CreateTaskInline"
  key_links:
    - from: "src/pages/App/Project/Tasks.tsx"
      to: "convex/tasks.ts"
      via: "useQuery for listByProject"
      pattern: "api\\.tasks\\.listByProject"
    - from: "src/pages/App/Project/CreateTaskInline.tsx"
      to: "convex/tasks.ts"
      via: "useMutation for create"
      pattern: "api\\.tasks\\.create"
    - from: "src/pages/App/Project/ProjectDetails.tsx"
      to: "src/pages/App/Project/Tasks.tsx"
      via: "Tasks component rendered inside project detail page"
      pattern: "<Tasks"
---

<objective>
Build the project task list UI with inline task creation, compact task rows (GitHub Issues style), and hide-completed toggle. This gives users a working task list they can immediately use to create and view tasks within a project.

Purpose: This is the primary task interaction surface. Users need to see their tasks and create new ones quickly.
Output: Working task list view on project pages with inline creation and compact row display.
</objective>

<execution_context>
@/home/lambda/.claude/get-shit-done/workflows/execute-plan.md
@/home/lambda/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-basic-tasks/02-RESEARCH.md
@.planning/phases/02-basic-tasks/02-01-SUMMARY.md

@convex/schema.ts
@src/pages/App/Project/ProjectDetails.tsx
@src/routes.tsx
@src/pages/App/AppSidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Badge component and create TaskRow + CreateTaskInline components</name>
  <files>src/components/ui/badge.tsx, src/pages/App/Project/TaskRow.tsx, src/pages/App/Project/CreateTaskInline.tsx</files>
  <action>
    1. Install shadcn Badge component:
    ```bash
    npx shadcn@latest add badge --yes
    ```
    This creates `src/components/ui/badge.tsx`.

    2. Create `src/pages/App/Project/TaskRow.tsx`:
    - Props: task object (with enriched status and assignee), onClick callback
    - Layout: horizontal flex row with items-center, gap-3, px-4, py-2, border-b
    - Hover: `hover:bg-accent cursor-pointer transition-colors`
    - Content (left to right):
      - Priority icon (flex-shrink-0):
        - urgent: `AlertCircle` icon, `text-red-500`
        - high: `ArrowUp` icon, `text-orange-500`
        - medium: `Minus` icon, `text-yellow-500`
        - low: `ArrowDown` icon, `text-gray-400`
      - Title: flex-1, min-w-0, text-sm font-medium, truncate. If task.completed, add `line-through text-muted-foreground`
      - Status Badge: use Badge component with variant="secondary". Apply status.color as a small colored dot (4px circle) before the text, not as background — this avoids contrast issues. Text is the status name.
      - Assignee Avatar: if assignee exists, show Avatar (h-6 w-6) with AvatarFallback showing first 2 chars of name uppercase
    - Import lucide-react icons: AlertCircle, ArrowUp, Minus, ArrowDown
    - Use `cn()` from `@/lib/utils` for conditional classes

    3. Create `src/pages/App/Project/CreateTaskInline.tsx`:
    - Props: `projectId: Id<"projects">`
    - State: title string, isCreating boolean
    - Uses `useMutation(api.tasks.create)` for task creation
    - Renders a form with single Input:
      - placeholder: "Add a task... (press Enter)"
      - border-dashed styling for visual distinction
      - On Enter (form submit): call create mutation with `{ projectId, title: title.trim() }`, clear input, refocus
      - Disable input while isCreating
      - On error: show toast with error message using the existing toast system (check if codebase uses sonner or shadcn toast — use whichever exists)
    - Keep focus on input after successful creation for rapid entry
    - Wrap in Plus icon row: show a `Plus` icon before the input for visual affordance
  </action>
  <verify>Run `npx tsc --noEmit` to verify types. Verify badge.tsx was created by shadcn CLI. Run `npm run lint`.</verify>
  <done>Badge component exists. TaskRow renders compact row with priority icon, title, status badge, assignee avatar. CreateTaskInline allows typing title + Enter to create task.</done>
</task>

<task type="auto">
  <name>Task 2: Create Tasks.tsx list view and integrate into ProjectDetails</name>
  <files>src/pages/App/Project/Tasks.tsx, src/pages/App/Project/ProjectDetails.tsx</files>
  <action>
    1. Create `src/pages/App/Project/Tasks.tsx`:
    - Props: `projectId: Id<"projects">`
    - Query: `useQuery(api.tasks.listByProject, { projectId, hideCompleted })` — reactive task list
    - State: `hideCompleted` boolean (default true), `selectedTaskId` (for future sheet integration, can be null for now)
    - Layout:
      - Header section: flex row with "Tasks" heading and hide-completed toggle
        - Toggle: use a Checkbox or a simple text button "Show completed" / "Hide completed"
        - Task count badge: show number of visible tasks
      - CreateTaskInline component below header
      - Task list: map over tasks, render TaskRow for each
        - onClick: set selectedTaskId (for now, just a no-op or console.log — Plan 03 wires the sheet)
      - Empty state: when tasks array is empty and not loading, show centered content:
        - Icon: `CheckSquare` from lucide-react (muted)
        - Text: "No tasks yet"
        - Subtext: "Create your first task using the input above"
      - Loading state: show skeleton or "Loading..." text while query is undefined
    - Sort: tasks come from backend already sorted by _creationTime desc

    2. Integrate Tasks into ProjectDetails.tsx:
    - Read the current ProjectDetails.tsx to understand its layout
    - Add the Tasks component below the existing project content
    - Pass the current projectId from route params
    - The Tasks component should be the primary content area of the project detail page
    - If ProjectDetails currently shows project info (name, description), keep that as a header and add Tasks below it

    NOTE: Do NOT wire up TaskDetailSheet in this plan — that's Plan 03. The onClick handler on TaskRow should just set `selectedTaskId` state for now (the sheet will be added in Plan 03).
  </action>
  <verify>
    Run `npm run lint` and `npx tsc --noEmit`. Start dev server with `npm run dev` briefly to verify no runtime errors on project page. The task list should render (empty state or with tasks if any exist).
  </verify>
  <done>Tasks.tsx renders task list with hide-completed toggle, inline creation, and empty state. ProjectDetails page shows task list. Users can create tasks via inline input and see them appear in the list in real-time.</done>
</task>

</tasks>

<verification>
1. `npm run lint` passes
2. `npx tsc --noEmit` passes
3. Badge component exists at src/components/ui/badge.tsx
4. TaskRow shows priority icon, title (with strikethrough for completed), status badge, assignee avatar
5. CreateTaskInline creates task on Enter, clears input, refocuses
6. Tasks.tsx shows task list with hide-completed toggle and empty state
7. ProjectDetails page renders Tasks component
8. Real-time updates work (creating task shows it immediately via Convex reactivity)
</verification>

<success_criteria>
- User can navigate to a project and see the task list (or empty state)
- User can type a title and press Enter to create a task inline
- Created task appears immediately in the list with status badge, priority icon
- User can toggle completed tasks visibility
- No lint or type errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-basic-tasks/02-02-SUMMARY.md`
</output>
