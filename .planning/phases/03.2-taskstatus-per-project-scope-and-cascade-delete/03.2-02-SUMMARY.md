---
phase: 03.2-taskstatus-per-project-scope-and-cascade-delete
plan: 02
subsystem: frontend
tags: [api-migration, ux-update, project-scoped]
dependencies:
  requires: [03.2-01]
  provides: [frontend-project-scoped-ui]
  affects: [KanbanBoard, TaskDetailSheet]
tech_stack:
  added: []
  patterns: [project-scoped-queries]
key_files:
  created: []
  modified: [src/pages/App/Project/KanbanBoard.tsx, src/pages/App/Project/AddColumnDialog.tsx, src/pages/App/Project/useTaskDetail.ts, src/pages/App/Project/KanbanColumn.tsx]
decisions:
  - frontend-uses-project-scoped-status-apis
  - cascade-delete-ux-messaging
metrics:
  duration_minutes: 2.0
  tasks_completed: 2
  files_modified: 4
  commits: 2
  completed_at: 2026-02-10T18:15:53Z
---

# Phase 03.2 Plan 02: Frontend Project-Scoped TaskStatus Migration Summary

**One-liner:** Updated all frontend components to use project-scoped taskStatus APIs (listByProject) and improved cascade delete UX messaging

## What Was Built

Migrated all frontend kanban board components from workspace-scoped to project-scoped taskStatus APIs. All status queries now use `api.taskStatuses.listByProject` with `projectId` instead of `listByWorkspace` with `workspaceId`. Updated UX to reflect new cascade delete behavior where deleting a status moves tasks to the default status rather than blocking.

### Component Updates

**KanbanBoard.tsx:**
- Changed statuses query from `listByWorkspace` to `listByProject`
- Updated `canDelete` logic to only check `!status.isDefault` (removed task count check)
- Changed AddColumnDialog prop from `workspaceId` to `projectId`

**AddColumnDialog.tsx:**
- Changed props type from `workspaceId: Id<"workspaces">` to `projectId: Id<"projects">`
- Updated component parameter destructuring to use `projectId`
- Changed `createStatus` mutation call to pass `projectId` instead of `workspaceId`

**useTaskDetail.ts:**
- Changed statuses query from `listByWorkspace` to `listByProject` with `projectId`
- Kept `workspaceId` parameter (still needed for diagrams/documents queries)

**KanbanColumn.tsx:**
- Updated delete dialog description to inform users: "Tasks in this column will be moved to the default status"
- Simplified delete menu item text (removed "Has tasks" state since cascade now handles it)
- Applied `text-destructive` class conditionally only when `canDelete` is true
- Delete now only disabled for default column (not based on task count)

## Deviations from Plan

None - plan executed exactly as written.

## Key Technical Decisions

**1. Project-scoped status queries throughout**
- All components now query statuses by project, enabling per-project workflow independence
- Frontend aligns with backend's project-scoped data model

**2. Cascade delete UX messaging**
- Delete confirmation clearly states tasks will be moved (not lost)
- Menu item text simplified to only show "Default column" when disabled
- No more "Has tasks" messaging since cascade handles task migration automatically

**3. Preserved workspaceId in useTaskDetail**
- Hook still receives `workspaceId` for other queries (diagrams, documents)
- Only status query migrated to `projectId` - maintains hook's multi-purpose design

## Verification Results

- ✅ `npm run lint` passed (0 errors, 0 warnings)
- ✅ `npm run build` succeeded (full production build)
- ✅ No references to `listByWorkspace` remain in frontend code
- ✅ No references to `workspaceId` in AddColumnDialog
- ✅ KanbanColumn delete dialog mentions tasks being moved to default status
- ✅ `canDelete` on KanbanColumn only checks `isDefault` (not task count)

## Files Changed

**Modified:**
- `/home/lambda/projects/ripple/src/pages/App/Project/KanbanBoard.tsx` - Project-scoped queries, updated canDelete logic
- `/home/lambda/projects/ripple/src/pages/App/Project/AddColumnDialog.tsx` - Project-scoped props and mutations
- `/home/lambda/projects/ripple/src/pages/App/Project/useTaskDetail.ts` - Project-scoped status query
- `/home/lambda/projects/ripple/src/pages/App/Project/KanbanColumn.tsx` - Cascade delete UX messaging

## Commits

- `6fefb80`: feat(03.2-02): update KanbanBoard and AddColumnDialog for project-scoped statuses
- `5273ae5`: feat(03.2-02): update useTaskDetail and KanbanColumn for project-scoped statuses

## Dependencies Impact

**Provides:**
- Frontend fully migrated to project-scoped status system
- UX reflects cascade delete behavior correctly

**Affects:**
- Users will see improved delete confirmation messaging
- Columns can now be deleted even with tasks (tasks cascade to default)

## Next Steps

1. Test cascade delete behavior in live environment
2. Optional: Clean up any legacy workspace-scoped status references elsewhere in codebase
3. Phase 03.2 complete - taskStatus system fully project-scoped end-to-end

## Self-Check: PASSED

✅ All modified files exist:
- FOUND: /home/lambda/projects/ripple/src/pages/App/Project/KanbanBoard.tsx
- FOUND: /home/lambda/projects/ripple/src/pages/App/Project/AddColumnDialog.tsx
- FOUND: /home/lambda/projects/ripple/src/pages/App/Project/useTaskDetail.ts
- FOUND: /home/lambda/projects/ripple/src/pages/App/Project/KanbanColumn.tsx

✅ Commits exist:
- FOUND: 6fefb80
- FOUND: 5273ae5

✅ Verification passed:
- Lint: 0 errors, 0 warnings
- Build: successful
- No listByWorkspace references remain in src/
- No workspaceId in AddColumnDialog
- Cascade delete messaging present
